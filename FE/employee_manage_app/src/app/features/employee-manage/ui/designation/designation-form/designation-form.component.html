<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-lg-6 col-md-8">
            <nz-card [nzBordered]="false" class="shadow-sm rounded-3">
                <div class="d-flex justify-content-between align-items-center mb-4 pb-3 border-bottom">
                    <h4 class="mb-0 fw-bold text-primary">
                        {{ isEditMode ? 'Cập Nhật Chức Danh' : 'Thêm Mới Chức Danh' }}
                    </h4>
                    <a nz-button nzType="link" (click)="onCancel()">
                        <span nz-icon nzType="close"></span>
                    </a>
                </div>

                <!-- Error State -->
                @if (error) {
                <nz-alert nzType="error" nzMessage="Lỗi" [nzDescription]="error.message" nzShowIcon class="mb-4">
                </nz-alert>
                }

                <!-- Form -->
                <form nz-form [formGroup]="form" (ngSubmit)="onSubmit()" nzLayout="vertical">
                    <!-- Name -->
                    <nz-form-item>
                        <nz-form-label nzRequired nzFor="designationName">Tên Chức Danh</nz-form-label>
                        <nz-form-control [nzErrorTip]="nameErrorTpl">
                            <input nz-input formControlName="designationName" id="designationName"
                                placeholder="Nhập tên chức danh" />
                            <ng-template #nameErrorTpl let-control>
                                @if (control.hasError('required')) { Tên chức danh là bắt buộc }
                                @if (control.hasError('minlength')) { Tên phải dài hơn 2 ký tự }
                            </ng-template>
                        </nz-form-control>
                    </nz-form-item>

                    <!-- Department Select -->
                    <nz-form-item>
                        <nz-form-label nzRequired nzFor="departmentId">Phòng Ban</nz-form-label>
                        <nz-form-control nzErrorTip="Vui lòng chọn phòng ban">
                            <nz-select formControlName="departmentId" id="departmentId" nzPlaceHolder="Chọn phòng ban">
                                @for (dept of departments; track dept.departmentId) {
                                <nz-option [nzValue]="dept.departmentId" [nzLabel]="dept.departmentName">
                                </nz-option>
                                }
                            </nz-select>
                        </nz-form-control>
                    </nz-form-item>

                    <!-- Actions -->
                    <div class="d-flex justify-content-end gap-3 mt-4 pt-3 border-top">
                        <button nz-button nzType="default" type="button" (click)="onCancel()" [disabled]="isLoading">
                            Hủy
                        </button>
                        <button nz-button nzType="primary" type="submit" [nzLoading]="isLoading"
                            [disabled]="!form.valid || isLoading">
                            {{ isEditMode ? 'Cập Nhật' : 'Thêm Mới' }}
                        </button>
                    </div>
                </form>
            </nz-card>
        </div>
    </div>
</div>